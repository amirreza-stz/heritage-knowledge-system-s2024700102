# Query 5: Count claims per source
# Works for all three patterns - adjust based on dataset

PREFIX ex: <http://example.org/heritage/s2024700102#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>

# For RDF Reification pattern:
SELECT ?source (COUNT(?claim) as ?claimCount) (AVG(?confidence) as ?avgConfidence)
WHERE {
    ?claim a rdf:Statement ;
        ex:source ?source ;
        ex:confidence ?confidence .
}
GROUP BY ?source
ORDER BY DESC(?claimCount)

# For Named Graphs pattern, use:
# SELECT ?source (COUNT(DISTINCT ?graph) as ?claimCount)
# WHERE {
#     GRAPH ?graph { ?s ?p ?o . }
#     GRAPH ?metadataGraph {
#         ?graph ex:source ?source .
#     }
# }

# For RDF-star pattern, use:
# SELECT ?source (COUNT(*) as ?claimCount)
# WHERE {
#     << ?s ?p ?o >> ex:source ?source .
# }
